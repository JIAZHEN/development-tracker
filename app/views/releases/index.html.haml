.row
  .col-lg-12
    %h1.page-header Releases

= render "shared/flash_messages"

.row
  .col-md-12
    .table-responsive
      %table#mytable.table.table-bordred.table-striped
        %thead
          %th JIRA Number
          %th Environment
          %th Dev
          %th QA
          %th Description
          %th Projects
          %th Status
          %th Edit
          %th Delete
        %tbody
          - @releases.each do |release|
            %tr
              %td= release.jira_number
              %td= release.environment.name
              %td= release.username
              %td= release.qa
              %td= release.description
              %td
                %button.btn.btn-success{"data-target" => "#releaseProject#{release.id}", "data-toggle" => "modal", :type => "button"}= release.projects.size
                / Modal.
                .modal.fade{:id => "releaseProject#{release.id}", "aria-hidden" => "true", "aria-labelledby" => "releaseProjectLabel", :role => "dialog", :tabindex => "-1"}
                  .modal-dialog
                    .modal-content
                      .modal-header
                        %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
                          %span{"aria-hidden" => "true"} Ã—
                        %h4#releaseProjectLabel.modal-title Projects
                      .modal-body
                        - release.projects.each do |project|
                          %h4= project.repository.name.capitalize
                          %p.lead
                            %small= "#{project.branch.name}: #{project.sha}"
                          %h4
                            %small Deployment Introduction
                          %p.lead= project.deployment_instruction
                          %h4
                            %small Rollback Instruction
                          %p.lead= project.rollback_instruction
                          %hr
              %td
                %button.btn{:class => "btn-#{release.status_colour}"}= release.status.name
              %td
                %a.btn.btn-default{:href => edit_release_path(release), :role => "button"} Resubmit
              %td
                %p{"data-placement" => "top", "data-toggle" => "tooltip", :title => "Delete"}
                  %button.btn.btn-danger.btn-xs{"data-target" => "#delete", "data-title" => "Delete", "data-toggle" => "modal"}
                    %span.fa.fa-trash

      .clearfix
